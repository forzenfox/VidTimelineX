# 自定义域名vx.forzenfox.com配置指南

## 一、配置概述

本文档详细说明如何将GitHub Pages部署配置为使用自定义域名vx.forzenfox.com。配置完成后，用户可以通过https://vx.forzenfox.com访问网站，而无需使用GitHub Pages默认的子域名。

GitHub Pages原生支持自定义域名，并且会自动为自定义域名提供免费的SSL证书（通过Let's Encrypt），无需手动配置HTTPS证书。

## 二、GitHub仓库配置

### 2.1 添加自定义域名

1. **登录GitHub并进入仓库**
   - 访问 https://github.com/your-username/VidTimelineX
   - 点击"Settings"选项卡

2. **进入Pages配置页面**
   - 在左侧菜单中找到"Pages"选项
   - 点击进入GitHub Pages设置页面

3. **配置自定义域名**
   - 在"Custom domain"输入框中输入：`vx.forzenfox.com`
   - 点击"Save"按钮保存配置

4. **启用HTTPS（重要）**
   - 勾选"Enforce HTTPS"选项
   - GitHub会自动为自定义域名申请SSL证书
   - 证书申请可能需要几分钟时间，耐心等待后刷新页面确认证书状态

### 2.2 验证域名所有权

GitHub Pages会自动验证域名所有权。通过正确配置DNS记录（见下一章节）后，GitHub会检测到域名指向正确的服务器，并完成验证。

## 三、DNS配置

### 3.1 DNS记录类型说明

为自定义域名vx.forzenfox.com配置DNS记录，需要添加以下记录：

| 记录类型 | 主机记录 | 记录值 | TTL | 说明 |
|---------|---------|--------|-----|------|
| A | @ | 185.199.108.153 | 自动 | 指向GitHub Pages服务器 |
| A | @ | 185.199.109.153 | 自动 | 指向GitHub Pages服务器 |
| A | @ | 185.199.110.153 | 自动 | 指向GitHub Pages服务器 |
| A | @ | 185.199.111.153 | 自动 | 指向GitHub Pages服务器 |
| CNAME | www | your-username.github.io | 自动 | www子域名跳转 |

### 3.2 A记录配置

A记录将域名直接指向GitHub Pages的IP地址。GitHub Pages使用以下四个IP地址：

- 185.199.108.153
- 185.199.109.153
- 185.199.110.153
- 185.199.111.153

**配置步骤**：

1. **登录域名管理控制台**
   - 登录您的域名注册商网站（如阿里云、腾讯云、GoDaddy、Namecheap等）

2. **进入DNS管理页面**
   - 找到域名管理或DNS设置选项

3. **添加A记录**
   - 主机记录：@（代表根域名）
   - 记录类型：A
   - 记录值：185.199.108.153
   - TTL：默认/自动

   重复此步骤，添加其他三个IP地址的A记录。

4. **等待DNS生效**
   - DNS记录通常在几分钟到几小时内生效使用
   - 可以以下命令验证DNS配置：

```bash
# Windows命令提示符
nslookup vx.forzenfox.com

# 或使用在线DNS查询工具
# 访问 https://dnschecker.org 查询全球DNS解析状态
```

### 3.3 CNAME记录配置（可选）

如果您希望www.vx.forzenfox.com也能访问网站，需要添加CNAME记录：

| 记录类型 | 主机记录 | 记录值 | TTL |
|---------|---------|--------|-----|
| CNAME | www | your-username.github.io | 自动 |

将your-username替换为您的GitHub用户名。

### 3.4 DNS配置验证

使用以下命令验证DNS配置是否正确：

```bash
# 查询A记录
dig vx.forzenfox.com +short

# 预期输出应该是以下四个IP地址之一：
# 185.199.108.153
# 185.199.109.153
# 185.199.110.153
# 185.199.111.153

# 查询CNAME记录（如果配置了）
dig www.vx.forzenfox.com +short
```

## 四、项目配置修改

### 4.1 已完成的配置修改

项目已自动完成以下配置修改：

**1. Vite构建配置**（frontend/vite.config.ts）

```typescript
// 自定义域名配置
const customDomain = env.VITE_CUSTOM_DOMAIN;
const baseUrl = customDomain 
  ? `https://${customDomain}/` 
  : (env.VITE_BASE_URL || "/");

return {
  base: baseUrl,
  // ...
};
```

**2. 环境变量配置**（frontend/.env.production）

```properties
# 自定义域名配置（使用自定义域名时取消注释并修改为你的域名）
# VITE_CUSTOM_DOMAIN=vx.forzenfox.com
```

**3. GitHub Actions工作流**（.github/workflows/deploy.yml）

- 添加了workflow_dispatch手动触发选项
- 支持通过输入参数指定自定义域名
- 自动生成CNAME文件到构建产物

### 4.2 修改自定义域名

如果您需要使用其他自定义域名，请修改以下位置：

1. **GitHub仓库设置**（必需）
   - Settings > Pages > Custom domain > 输入新域名 > Save

2. **GitHub Actions工作流**（可选，用于默认值）
   - 文件：.github/workflows/deploy.yml
   - 修改：`VITE_CUSTOM_DOMAIN: vx.forzenfox.com`

3. **本地环境变量**（可选，用于本地预览）
   - 文件：frontend/.env.production
   - 取消注释并修改：`VITE_CUSTOM_DOMAIN=your-domain.com`

## 五、部署流程

### 5.1 自动化部署

将代码推送到master分支后，GitHub Actions将自动执行部署：

```bash
# 提交代码变更
git add .
git commit -m "Configure custom domain vx.forzenfox.com"
git push origin master
```

部署完成后，访问 https://vx.forzenfox.com 即可查看网站。

### 5.2 手动触发部署（带自定义域名参数）

如果您修改了自定义域名，可以通过以下步骤手动触发部署：

1. 进入GitHub仓库的Actions页面
2. 选择"Deploy to GitHub Pages"工作流
3. 点击"Run workflow"
4. 在"Custom domain"输入框中输入您的域名（如vx.forzenfox.com）
5. 点击"Run workflow"确认

### 5.3 本地构建预览

在本地测试自定义域名配置：

```bash
# 进入前端目录
cd frontend

# 设置自定义域名环境变量
$env:VITE_CUSTOM_DOMAIN="vx.forzenfox.com"

# 构建项目
npm run build

# 预览构建结果
npm run preview
```

## 六、HTTPS配置

### 6.1 SSL证书自动配置

GitHub Pages通过Let's Encrypt为自定义域名自动提供SSL证书。配置完成后，GitHub会自动：

1. 验证域名所有权
2. 申请SSL证书
3. 配置HTTPS重定向

### 6.2 证书状态检查

1. 进入仓库Settings > Pages
2. 查看"Custom domain"下方的证书状态
3. 如果显示"Enable HTTPS"已勾选且证书有效，表示配置成功

### 6.3 证书问题排查

**问题1：证书申请失败**

可能原因：
- DNS记录未正确配置或未完全生效
- 域名被其他服务占用

解决方案：
- 确认A记录已正确配置并等待DNS生效
- 检查域名是否正确指向GitHub Pages

**问题2：HTTPS无法访问**

可能原因：
- 证书尚未签发完成
- 浏览器缓存了旧的DNS记录

解决方案：
- 等待几分钟后重试
- 清除浏览器DNS缓存或使用隐私模式访问

## 七、验证与测试

### 7.1 DNS解析测试

```bash
# 使用nslookup查询
nslookup vx.forzenfox.com

# 使用dig查询（如果安装了Git Bash或WSL）
dig vx.forzenfox.com +short
```

**预期结果**：返回185.199.108.153 - 185.199.111.153中的任一IP地址

### 7.2 网站访问测试

1. **HTTP访问测试**
   - 浏览器访问：http://vx.forzenfox.com
   - 预期：自动重定向到HTTPS

2. **HTTPS访问测试**
   - 浏览器访问：https://vx.forzenfox.com
   - 预期：正常显示网站内容，地址栏显示安全锁图标

3. **证书信息检查**
   - 点击地址栏安全锁图标
   - 查看证书颁发机构和有效期

### 7.3 浏览器开发者工具检查

打开浏览器开发者工具（F12），检查：

1. **Network标签**
   - 所有资源请求状态码应为200
   - 无404错误

2. **Console标签**
   - 无JavaScript错误
   - 无Mixed Content警告

## 八、常见问题与解决方案

### 问题1：DNS解析未生效

**症状**：访问vx.forzenfox.com显示"无法访问"或DNS错误

**解决方案**：

1. 确认已在域名管理控制台添加了所有四个A记录
2. 等待最多48小时让DNS完全生效（通常几分钟到几小时）
3. 使用在线DNS检查工具验证配置：
   - 访问 https://dnschecker.org
   - 输入vx.forzenfox.com
   - 确认全球各地都有绿色对勾

### 问题2：GitHub Pages未识别自定义域名

**症状**：GitHub仓库Settings中Custom domain显示警告

**解决方案**：

1. 确认DNS记录已正确配置
2. 等待DNS完全生效后点击"Recheck"按钮
3. 确认域名没有被其他服务占用

### 问题3：网站样式或资源加载失败

**症状**：页面显示但不完整，图片或样式缺失

**解决方案**：

1. 确认Vite配置中的base URL已正确设置为https://vx.forzenfox.com/
2. 检查浏览器控制台中的资源加载错误
3. 确保没有使用绝对路径引用资源

### 问题4：无限重定向循环

**症状**：浏览器显示"ERR_TOO_MANY_REDIRECTS"

**解决方案**：

1. 检查vite.config.ts中的base配置
2. 确认没有在应用中手动设置HTTP重定向
3. 在GitHub Pages设置中勾选"Enforce HTTPS"

### 问题5：www子域名无法访问

**症状**：访问www.vx.forzenfox.com显示404

**解决方案**：

1. 添加CNAME记录：www指向your-username.github.io
2. 等待DNS生效后重试

## 九、配置总结

### 9.1 完成的配置项目

| 配置项 | 状态 | 说明 |
|-------|------|------|
| Vite构建配置 | ✅ 已完成 | 支持自定义域名base URL |
| 环境变量配置 | ✅ 已完成 | 可配置VITE_CUSTOM_DOMAIN |
| GitHub Actions | ✅ 已完成 | 支持自定义域名部署 |
| CNAME文件 | ✅ 已完成 | 自动生成到构建产物 |

### 9.2 待手动完成的配置

| 配置项 | 说明 |
|-------|------|
| GitHub仓库设置 | 在Settings > Pages中添加自定义域名vx.forzenfox.com |
| DNS A记录 | 在域名管理控制台添加四个A记录 |
| DNS CNAME记录 | （可选）添加www子域名记录 |

### 9.3 部署后访问地址

| 环境 | 访问地址 |
|-----|---------|
| 自定义域名 | https://vx.forzenfox.com |
| GitHub Pages（备选） | https://your-username.github.io/VidTimelineX/ |

## 十、参考资源

- GitHub Pages自定义域名文档：https://docs.github.com/en/pages/configuring-a-custom-domain-for-your-github-pages-site
- Let's Encrypt证书信息：https://letsencrypt.org/
- DNS配置验证工具：https://dnschecker.org/

---

**文档版本**：1.0.0

**创建日期**：2026年2月1日

**最后更新**：2026年2月1日
